From: <Saved by Blink>
Subject: 
Date: Tue, 6 Jun 2016 16:26:07 -0000
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--pr89mw5K9oOVe4XTJdgsZe9Rqo1oizxR16zChIOVep----"

------MultipartBoundary--pr89mw5K9oOVe4XTJdgsZe9Rqo1oizxR16zChIOVep----
Content-Type: text/html
Content-ID: <frame-5274-AEBEDFA5-EC78-4993-A458-4457D879F999@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: file:///C:/Users/shu/workspace/sega-xy-diagnostic/README.md

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html; charset=
=3Dwindows-1252"></head><body><pre style=3D"word-wrap: break-word; white-sp=
ace: pre-wrap;">#Sega XY Diagnostic ROM
####David Shuman (davidshuman@gmail.com)
####v1.0 August 22, 2015
####Please do not redistribute the diagnostic ROM data without this README.

This README should be distributed in a ZIP archive also containing the file=
 "sega-xydiag-U25.bin."  The .bin file is object code that may be programme=
d into a 2716 EPROM. =20

The programmed 2716 EPROM replaces U25 on the CPU board to provide:
  * Full-screen grid patterns, in seven different colors, for monitor adjus=
tment
  * Improved RAM testing, including tests of RAM on the CPU board and Unive=
rsal Sound Board
The new ROM provides only these diagnostic functions and cannot be used to =
run the game.  To run the game, reinstall the original U25 ROM on the CPU b=
oard. =20

###REQUIRED HARDWARE =20
For the diagnostic ROM to operate, the G80 system must have, in addition to=
 a working power supply:
  * A working CPU board (with or without good RAM at U26-U29)
  * A working pair of XY Control and XY Timing boards (with or without good=
 RAM at U30, U29, U28, U26, U25, and U24 -- HOWEVER, working 2114 RAMs must=
 be installed at U31 and U27 for the diagnostics to run).  These boards pro=
vide clock and interrupt signals to the CPU board. =20

Neither the EPROM board nor the Speech board is required to run the diagnos=
tic ROM.  Also note that any of the boards can be inserted into any of the =
card cage slots.  The six slots are identical and none is specific to any o=
ne card. =20

###OPTIONAL HARDWARE
  * Vector Monitor:  For displaying the grid patterns and the results of th=
e RAM test.  (The LED on the CPU Board can also be used to interpret the re=
sults of the RAM test.)
  * Universal Sound Board:  The new diagnostic ROM includes a test of the 6=
116 RAM at U50 and U51 on the Universal Sound Board used in Star Trek, Tac/=
Scan, and Zektor.  If this board is not present, the diagnostics will repor=
t U50 and U51 as faulty.
  * Control Panel:  the P1 start button can be used to advance from the RAM=
 test to the grid pattern, and to cycle through the available colors of the=
 grid pattern.  The pushbutton on the CPU board may also be used for this p=
urpose.

###RAM TEST
The original Sega self-test tested only the eight 2114 RAM chips on the XY =
Control board, and was prone to reporting false negatives -- that is, the s=
elf-test would often fail to detect faulty RAMs that, during game play, wou=
ld cause errors in program execution or graphics.  The tests performed by t=
he new diagnostic ROM are designed to be more thorough and reliable, and al=
so test, in addition to the XY Control board RAM, the four 2114 RAMs on the=
 CPU board and the two 6116 RAMs on the Universal Sound Board (if that boar=
d is present). =20

When the diagnostic ROM is installed, the RAM test will run automatically w=
hen the system is powered up and RAMs U31 and U27 on the XY Control board (=
which the test uses as scratchpad RAM and for storing vector data) are good=
.  If the test fails to run, try installing new 2114 RAM chips at U31 and U=
27 on the XY Control board. =20

The RAM test writes and reads various data to system RAM, reads it back, an=
d verifies that the data read is the same as the data written.  If the data=
 read from a given memory location does not match the data written, the phy=
sical chip associated with that memory location is identified as bad. =20

###Display of RAM Test Results

The RAM test takes only a second to complete.  When it is finished, the mon=
itor will display a status word comprising fourteen characters, each a "1" =
or a "0."  A "1" indicates that the RAM chip associated with that character=
 passed the RAM test with no errors.  A "0" indicates that one or more memo=
ry locations in the RAM chip associated with that character failed one or m=
ore write/read tests. =20
```
Table 1:  Correlation of Status Word Digits With Physical Chips
Char        Chip             Char        Chip             Char        Chip
1st       CPU bd U26         5th     XY Ctl bd U31        13th    Sound bd =
U51
2nd       CPU bd U27         6th     XY Ctl bd U30        14th    Sound bd =
U50
3rd       CPU bd U28         7th     XY Ctl bd U29
4th       CPU bd U29         8th     XY Ctl bd U28
                             9th     XY Ctl bd U27
                             10th    XY Ctl bd U26
                             11th    XY Ctl bd U25
                             12th    XY Ctl bd U24
```
For example, if the display shows:
```
               1 1 1 1   1 1 1 0 1 1 1 1   1 1
```
All RAM chips tested OK except for U28 on the XY Control board.

Similarly, if the display shows:
```
               0 1 1 1   1 1 1 1 1 1 1 1   0 0
```
All RAM chips tested OK except for U26 on the CPU board and chips U50 and U=
51 on the Universal Sound Board.  Note that the last two digits will also d=
isplay "0" if the Universal Sound Board, which is used only in Star Trek an=
d Tac/Scan, is not installed. =20

To provide test results information when the vector monitor is missing or n=
on-operational, the LED on the CPU board provides a second visual indicatio=
n of the results of the RAM test by blinking either an "All Clear" indicati=
on or a flash code indicating a bad RAM.  The flash code can be interpreted=
 as follows: =20

 * One flash followed by a long pause:  all chips tested OK.
 * One to four flashes, representing a first digit; then a short pause; the=
n one to four flashes, representing a second digit; then a long pause:  at =
least one chip failed the RAM test.

```
Table 2:  Two-Digit LED Flash Codes
  "C." =3D CPU Board   "X." =3D XY Control Board   "S." =3D Universal Sound=
 Board
       first digit =3D&gt;        1       2       3       4
   second digit       1    C.U26   X.U31   X.U27   S.U51
        |             2    C.U27   X.U30   X.U26   S.U50
        V             3    C.U28   X.U29   X.U25    ---
                      4    C.U29   X.U28   X.U24    ---
```
For example, if the LED flashes 3 times, then pauses, then four times, foll=
owed by a longer pause, the RAM test has identified U24 on the XY Control B=
oard as faulty. =20

The LED flash code is capable of identifying only a single chip.  If more t=
han one chip fails the RAM test, only the chip represented by the lowest-or=
der character in the status word (see Table 1 above) will be identified by =
the LED flash code.  For example, if both CPU board chip U27 and XY Control=
 board chip U28 fail the RAM test, the LED will blink the code for C.U27 bu=
t not for X.U28.  If, in this example, C.U27 were replaced with a good RAM =
and the test run again, the LED would then blink the code indicating X.U28 =
is bad. =20

There are two additional 2114 RAM chips on the Universal Sound Board, U44 a=
nd U45, that cannot be directly accessed by the CPU board and consequently =
cannot be tested by the new diagnostic ROM.  To test U44 and U45, swap them=
 with other 2114's on the CPU board or XY Control board and re-run the RAM =
test. =20

To exit the RAM test and display the grid pattern, press P1 Start on the co=
ntrol panel or the pushbutton on the CPU board near the LED.  =20

###GRID TEST PATTERN

The original Sega self-test did not provide an adequate suite of graphical =
test patterns for adjusting the purity and convergence of the vector monito=
r.  The new diagnostic ROM provides a full-screen grid pattern suitable for=
 detecting and correcting purity and convergence problems as well as adjust=
ing width, height, and centering. =20

The first pattern displayed after exiting the RAM test will be a white grid=
.  Press P1 Start or the CPU pushbutton to change the grid color to the nex=
t color in the cycle: =20
  white =3D&gt; red =3D&gt; green =3D&gt; blue =3D&gt; yellow (R+G) =3D&gt;=
 purple (R+B) =3D&gt; aqua (B+G) =3D&gt; white (R+B+G) =20

As with any image that extends along the edges of the screen, the grid test=
 pattern places moderate strain on the deflection circuitry of the vector m=
onitor.  Accordingly, it is advised that the grid pattern be displayed no l=
onger than is necessary to perform adjustments to the monitor.  </pre></bod=
y></html>
------MultipartBoundary--pr89mw5K9oOVe4XTJdgsZe9Rqo1oizxR16zChIOVep------
